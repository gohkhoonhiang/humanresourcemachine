<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html;charset=utf-8">
  <title>interpreter.py</title>
  <link rel="stylesheet" href="{{ static_url('css/pycco.css') }}">
</head>
<body>
<div id='container'>
  <div id="background"></div>
  <div class='section'>
    <div class='docs'><h1>interpreter.py</h1></div>
  </div>
  <div class='clearall'>
  <div class='section' id='section-0'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-0'>#</a>
      </div>
      <p>This is very basic interpreter for the Human Resource Machine in-game
instructions.</p>
<p>This code is far from complete and polished. Certainly there will be bugs as
well.</p>
<p>If time permits in the future, I will refactor the code cleanly.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">argparse</span>
<span class="kn">import</span> <span class="nn">os.path</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-1'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-1'>#</a>
      </div>
      <p>This flag is for enabling log.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-2'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-2'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="n">verbose</span> <span class="o">=</span> <span class="bp">False</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-3'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-3'>#</a>
      </div>
      <p>Initialize the memory space of the VM.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">init_vm</span><span class="p">(</span><span class="n">memspace</span><span class="p">,</span> <span class="n">consts</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-4'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-4'>#</a>
      </div>
      <p>Args:
    memspace (int): Size of memory to be created
    consts (list): List of constants to be initialized in memory</p>
<p>Returns:
    mem (list): Initialized memory space</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">print_log</span><span class="p">(</span><span class="s2">&quot;init vm...&quot;</span><span class="p">)</span>
    <span class="n">print_log</span><span class="p">(</span><span class="s2">&quot;memspace: </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">memspace</span><span class="p">)</span>
    <span class="n">mem</span> <span class="o">=</span> <span class="p">[</span><span class="bp">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">memspace</span>
    <span class="n">index</span> <span class="o">=</span> <span class="n">memspace</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="k">while</span> <span class="n">consts</span><span class="p">:</span>
        <span class="n">const</span> <span class="o">=</span> <span class="n">consts</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">mem</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">const</span>
        <span class="n">index</span> <span class="o">=</span> <span class="n">index</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="n">print_log</span><span class="p">(</span><span class="s2">&quot;mem: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">mem</span><span class="p">)</span>
    <span class="n">print_log</span><span class="p">(</span><span class="s2">&quot;init done...&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">mem</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-5'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-5'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">init_labels</span><span class="p">(</span><span class="n">commands</span><span class="p">):</span>
    <span class="n">labels</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s2">&quot;(?P&lt;label&gt;\w+):&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">index</span><span class="p">,</span><span class="n">cmd</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">commands</span><span class="p">):</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">m</span><span class="p">:</span>
            <span class="n">lbl</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s2">&quot;label&quot;</span><span class="p">)</span>
            <span class="n">labels</span><span class="p">[</span><span class="n">lbl</span><span class="p">]</span> <span class="o">=</span> <span class="n">index</span>
    <span class="n">print_log</span><span class="p">(</span><span class="s2">&quot;labels: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">labels</span><span class="p">)</span>
    <span class="n">print_log</span><span class="p">(</span><span class="s2">&quot;init labels done...&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">labels</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-6'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-6'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">run_commands</span><span class="p">(</span><span class="n">mem</span><span class="p">,</span> <span class="n">commands</span><span class="p">,</span> <span class="n">inputs</span><span class="p">):</span>
    <span class="n">print_log</span><span class="p">(</span><span class="s2">&quot;start running commands...&quot;</span><span class="p">)</span>
    <span class="n">labels</span> <span class="o">=</span> <span class="n">init_labels</span><span class="p">(</span><span class="n">commands</span><span class="p">)</span>
    <span class="n">outputs</span> <span class="o">=</span> <span class="n">interpret</span><span class="p">(</span><span class="n">mem</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">commands</span><span class="p">,</span> <span class="n">inputs</span><span class="p">)</span>
    <span class="n">print_log</span><span class="p">(</span><span class="s2">&quot;end running commands...&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">outputs</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-7'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-7'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">interpret</span><span class="p">(</span><span class="n">mem</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">commands</span><span class="p">,</span> <span class="n">inputs</span><span class="p">):</span>
    <span class="n">outputs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">steps</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">print_log</span><span class="p">(</span><span class="s2">&quot;interpreting...&quot;</span><span class="p">)</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s2">&quot;\[(?P&lt;addr&gt;\w+)\]&quot;</span><span class="p">)</span>
    <span class="n">sub</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s2">&quot;(\s)*SUB(\s)+\[(?P&lt;addr&gt;\w+)\]|(\s)*SUB(\s)+((?P&lt;index&gt;\w+))&quot;</span><span class="p">)</span>
    <span class="n">add</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s2">&quot;(\s)*ADD(\s)+\[(?P&lt;addr&gt;\w+)\]|(\s)*ADD(\s)+((?P&lt;index&gt;\w+))&quot;</span><span class="p">)</span>
    <span class="n">jpz</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s2">&quot;(\s)*JUMPZ(\s)+(?P&lt;label&gt;\w+)&quot;</span><span class="p">)</span>
    <span class="n">jpn</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s2">&quot;(\s)*JUMPN(\s)+(?P&lt;label&gt;\w+)&quot;</span><span class="p">)</span>
    <span class="n">jmp</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s2">&quot;(\s)*JUMP(\s)+(?P&lt;label&gt;\w+)&quot;</span><span class="p">)</span>
    <span class="n">bup</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s2">&quot;(\s)*BUMPUP(\s)+\[(?P&lt;addr&gt;\w+)\]|(\s)*BUMPUP(\s)+(?P&lt;index&gt;\w+)&quot;</span><span class="p">)</span>
    <span class="n">bdn</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s2">&quot;(\s)*BUMPDN(\s)+\[(?P&lt;addr&gt;\w+)\]|(\s)*BUMPDN(\s)+(?P&lt;index&gt;\w+)&quot;</span><span class="p">)</span>
    <span class="n">cpt</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s2">&quot;(\s)*COPYTO(\s)+\[(?P&lt;addr&gt;\w+)\]|(\s)*COPYTO(\s)+(?P&lt;index&gt;\w+)&quot;</span><span class="p">)</span>
    <span class="n">cpf</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s2">&quot;(\s)*COPYFROM(\s)+\[(?P&lt;addr&gt;\w+)\]|(\s)*COPYFROM(\s)+(?P&lt;index&gt;\w+)&quot;</span><span class="p">)</span>
    <span class="n">ptr</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">x</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">print_log</span><span class="p">(</span><span class="s2">&quot;mem: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">mem</span><span class="p">)</span>
        <span class="n">cmd</span> <span class="o">=</span> <span class="n">commands</span><span class="p">[</span><span class="n">ptr</span><span class="p">]</span>
        <span class="n">print_log</span><span class="p">(</span><span class="s2">&quot;interpreting command: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">cmd</span><span class="p">)</span>
        <span class="k">if</span> <span class="s2">&quot;INBOX&quot;</span> <span class="ow">in</span> <span class="n">cmd</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">inputs</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">elif</span> <span class="s2">&quot;OUTBOX&quot;</span> <span class="ow">in</span> <span class="n">cmd</span><span class="p">:</span>
            <span class="n">outputs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="n">x</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">elif</span> <span class="s2">&quot;ADD&quot;</span> <span class="ow">in</span> <span class="n">cmd</span><span class="p">:</span>
            <span class="n">m</span> <span class="o">=</span> <span class="n">add</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s2">&quot;addr&quot;</span><span class="p">):</span>
                <span class="n">i</span> <span class="o">=</span> <span class="n">get_addr</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
                <span class="n">addr</span> <span class="o">=</span> <span class="n">get_val_from_mem</span><span class="p">(</span><span class="n">mem</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
                <span class="n">x</span> <span class="o">=</span> <span class="n">add_raw</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">get_val_from_mem</span><span class="p">(</span><span class="n">mem</span><span class="p">,</span> <span class="n">addr</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">i</span> <span class="o">=</span> <span class="n">get_index</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
                <span class="n">x</span> <span class="o">=</span> <span class="n">add_raw</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">get_val_from_mem</span><span class="p">(</span><span class="n">mem</span><span class="p">,</span> <span class="n">i</span><span class="p">))</span>
        <span class="k">elif</span> <span class="s2">&quot;SUB&quot;</span> <span class="ow">in</span> <span class="n">cmd</span><span class="p">:</span>
            <span class="n">m</span> <span class="o">=</span> <span class="n">sub</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s2">&quot;addr&quot;</span><span class="p">):</span>
                <span class="n">i</span> <span class="o">=</span> <span class="n">get_addr</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
                <span class="n">addr</span> <span class="o">=</span> <span class="n">get_val_from_mem</span><span class="p">(</span><span class="n">mem</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
                <span class="n">x</span> <span class="o">=</span> <span class="n">sub_raw</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">get_val_from_mem</span><span class="p">(</span><span class="n">mem</span><span class="p">,</span> <span class="n">addr</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">i</span> <span class="o">=</span> <span class="n">get_index</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
                <span class="n">x</span> <span class="o">=</span> <span class="n">sub_raw</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">get_val_from_mem</span><span class="p">(</span><span class="n">mem</span><span class="p">,</span> <span class="n">i</span><span class="p">))</span>
        <span class="k">elif</span> <span class="s2">&quot;JUMPZ&quot;</span> <span class="ow">in</span> <span class="n">cmd</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">cmp_raw</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="s2">&quot;eq&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span>
                <span class="n">m</span> <span class="o">=</span> <span class="n">jpz</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
                <span class="n">lbl</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s2">&quot;label&quot;</span><span class="p">)</span>
                <span class="n">ptr</span> <span class="o">=</span> <span class="n">labels</span><span class="p">[</span><span class="n">lbl</span><span class="p">]</span>
        <span class="k">elif</span> <span class="s2">&quot;JUMPN&quot;</span> <span class="ow">in</span> <span class="n">cmd</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">cmp_raw</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="s2">&quot;lt&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span>
                <span class="n">m</span> <span class="o">=</span> <span class="n">jpn</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
                <span class="n">lbl</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s2">&quot;label&quot;</span><span class="p">)</span>
                <span class="n">ptr</span> <span class="o">=</span> <span class="n">labels</span><span class="p">[</span><span class="n">lbl</span><span class="p">]</span>
        <span class="k">elif</span> <span class="s2">&quot;JUMP&quot;</span> <span class="ow">in</span> <span class="n">cmd</span><span class="p">:</span>
            <span class="n">m</span> <span class="o">=</span> <span class="n">jmp</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
            <span class="n">lbl</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s2">&quot;label&quot;</span><span class="p">)</span>
            <span class="n">ptr</span> <span class="o">=</span> <span class="n">labels</span><span class="p">[</span><span class="n">lbl</span><span class="p">]</span>
        <span class="k">elif</span> <span class="s2">&quot;BUMPUP&quot;</span> <span class="ow">in</span> <span class="n">cmd</span><span class="p">:</span>
            <span class="n">m</span> <span class="o">=</span> <span class="n">bup</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s2">&quot;addr&quot;</span><span class="p">):</span>
                <span class="n">i</span> <span class="o">=</span> <span class="n">get_addr</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
                <span class="n">addr</span> <span class="o">=</span> <span class="n">get_val_from_mem</span><span class="p">(</span><span class="n">mem</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
                <span class="n">mem</span><span class="p">[</span><span class="n">addr</span><span class="p">]</span> <span class="o">=</span> <span class="n">add_raw</span><span class="p">(</span><span class="n">get_val_from_mem</span><span class="p">(</span><span class="n">mem</span><span class="p">,</span> <span class="n">addr</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
                <span class="n">x</span> <span class="o">=</span> <span class="n">get_val_from_mem</span><span class="p">(</span><span class="n">mem</span><span class="p">,</span> <span class="n">addr</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">i</span> <span class="o">=</span> <span class="n">get_index</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
                <span class="n">mem</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">add_raw</span><span class="p">(</span><span class="n">get_val_from_mem</span><span class="p">(</span><span class="n">mem</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
                <span class="n">x</span> <span class="o">=</span> <span class="n">get_val_from_mem</span><span class="p">(</span><span class="n">mem</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
        <span class="k">elif</span> <span class="s2">&quot;BUMPDN&quot;</span> <span class="ow">in</span> <span class="n">cmd</span><span class="p">:</span>
            <span class="n">m</span> <span class="o">=</span> <span class="n">bdn</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s2">&quot;addr&quot;</span><span class="p">):</span>
                <span class="n">i</span> <span class="o">=</span> <span class="n">get_addr</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
                <span class="n">addr</span> <span class="o">=</span> <span class="n">get_val_from_mem</span><span class="p">(</span><span class="n">mem</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
                <span class="n">mem</span><span class="p">[</span><span class="n">addr</span><span class="p">]</span> <span class="o">=</span> <span class="n">sub_raw</span><span class="p">(</span><span class="n">get_val_from_mem</span><span class="p">(</span><span class="n">mem</span><span class="p">,</span> <span class="n">addr</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
                <span class="n">x</span> <span class="o">=</span> <span class="n">get_val_from_mem</span><span class="p">(</span><span class="n">mem</span><span class="p">,</span> <span class="n">addr</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">i</span> <span class="o">=</span> <span class="n">get_index</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
                <span class="n">mem</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">sub_raw</span><span class="p">(</span><span class="n">get_val_from_mem</span><span class="p">(</span><span class="n">mem</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
                <span class="n">x</span> <span class="o">=</span> <span class="n">get_val_from_mem</span><span class="p">(</span><span class="n">mem</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
        <span class="k">elif</span> <span class="s2">&quot;COPYTO&quot;</span> <span class="ow">in</span> <span class="n">cmd</span><span class="p">:</span>
            <span class="n">m</span> <span class="o">=</span> <span class="n">cpt</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s2">&quot;addr&quot;</span><span class="p">):</span>
                <span class="n">i</span> <span class="o">=</span> <span class="n">get_addr</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
                <span class="n">addr</span> <span class="o">=</span> <span class="n">get_val_from_mem</span><span class="p">(</span><span class="n">mem</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
                <span class="n">mem</span><span class="p">[</span><span class="n">addr</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">i</span> <span class="o">=</span> <span class="n">get_index</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
                <span class="n">mem</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span>
        <span class="k">elif</span> <span class="s2">&quot;COPYFROM&quot;</span> <span class="ow">in</span> <span class="n">cmd</span><span class="p">:</span>
            <span class="n">m</span> <span class="o">=</span> <span class="n">cpf</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s2">&quot;addr&quot;</span><span class="p">):</span>
                <span class="n">i</span> <span class="o">=</span> <span class="n">get_addr</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
                <span class="n">addr</span> <span class="o">=</span> <span class="n">get_val_from_mem</span><span class="p">(</span><span class="n">mem</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
                <span class="n">x</span> <span class="o">=</span> <span class="n">get_val_from_mem</span><span class="p">(</span><span class="n">mem</span><span class="p">,</span> <span class="n">addr</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">i</span> <span class="o">=</span> <span class="n">get_index</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
                <span class="n">x</span> <span class="o">=</span> <span class="n">get_val_from_mem</span><span class="p">(</span><span class="n">mem</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
        <span class="k">elif</span> <span class="s2">&quot;END&quot;</span> <span class="ow">in</span> <span class="n">cmd</span><span class="p">:</span>
            <span class="k">break</span>
        <span class="n">ptr</span> <span class="o">=</span> <span class="n">ptr</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">steps</span> <span class="o">=</span> <span class="n">steps</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="n">print_log</span><span class="p">(</span><span class="s2">&quot;interpreted in </span><span class="si">%d</span><span class="s2"> steps with </span><span class="si">%d</span><span class="s2"> commands&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">steps</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">commands</span><span class="p">)))</span>
    <span class="k">return</span> <span class="n">outputs</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-8'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-8'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">add_raw</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">left</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">type</span><span class="p">(</span><span class="n">right</span><span class="p">):</span>
        <span class="n">print_error</span><span class="p">(</span><span class="s2">&quot;Unable to add values of different types </span><span class="si">%s</span><span class="s2"> and </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">left</span><span class="p">),</span> <span class="nb">type</span><span class="p">(</span><span class="n">right</span><span class="p">)))</span>
        <span class="nb">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">left</span><span class="p">)</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="n">right</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
        <span class="n">print_error</span><span class="p">(</span><span class="s2">&quot;Unable to add characters together&quot;</span><span class="p">)</span>
        <span class="nb">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-9'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-9'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">sub_raw</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">left</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">type</span><span class="p">(</span><span class="n">right</span><span class="p">):</span>
        <span class="n">print_error</span><span class="p">(</span><span class="s2">&quot;Unable to sub values of different types </span><span class="si">%s</span><span class="s2"> and </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">left</span><span class="p">),</span> <span class="nb">type</span><span class="p">(</span><span class="n">right</span><span class="p">)))</span>
        <span class="nb">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">left</span><span class="p">)</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="n">right</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">ord</span><span class="p">(</span><span class="n">left</span><span class="p">)</span> <span class="o">-</span> <span class="nb">ord</span><span class="p">(</span><span class="n">right</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-10'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-10'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">cmp_raw</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">op</span><span class="p">,</span> <span class="n">right</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">left</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">left</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
        <span class="n">left</span> <span class="o">=</span> <span class="nb">ord</span><span class="p">(</span><span class="n">left</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">right</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">right</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
        <span class="n">right</span> <span class="o">=</span> <span class="nb">ord</span><span class="p">(</span><span class="n">right</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">compare</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">op</span><span class="p">,</span> <span class="n">right</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-11'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-11'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">compare</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">op</span><span class="p">,</span> <span class="n">right</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">op</span> <span class="o">==</span> <span class="s2">&quot;eq&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">left</span> <span class="o">==</span> <span class="n">right</span>
    <span class="k">elif</span> <span class="n">op</span> <span class="o">==</span> <span class="s2">&quot;ne&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">left</span> <span class="o">!=</span> <span class="n">right</span>
    <span class="k">elif</span> <span class="n">op</span> <span class="o">==</span> <span class="s2">&quot;lt&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">left</span> <span class="o">&lt;</span> <span class="n">right</span>
    <span class="k">elif</span> <span class="n">op</span> <span class="o">==</span> <span class="s2">&quot;gt&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">left</span> <span class="o">&gt;</span> <span class="n">right</span>
    <span class="k">elif</span> <span class="n">op</span> <span class="o">==</span> <span class="s2">&quot;lte&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">left</span> <span class="o">&lt;=</span> <span class="n">right</span>
    <span class="k">elif</span> <span class="n">op</span> <span class="o">==</span> <span class="s2">&quot;gte&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">left</span> <span class="o">&gt;=</span> <span class="n">right</span>
    <span class="n">print_error</span><span class="p">(</span><span class="s2">&quot;Invalid operation </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">op</span><span class="p">)</span>
    <span class="nb">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-12'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-12'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">get_val_from_mem</span><span class="p">(</span><span class="n">mem</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
    <span class="n">val</span> <span class="o">=</span> <span class="n">mem</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">val</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-13'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-13'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">get_index</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s2">&quot;index&quot;</span><span class="p">))</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-14'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-14'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">get_addr</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s2">&quot;addr&quot;</span><span class="p">))</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-15'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-15'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">get_raw_val</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">val</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">val</span>
    <span class="k">return</span> <span class="bp">None</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-16'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-16'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">read_commands</span><span class="p">(</span><span class="n">file_name</span><span class="p">):</span>
    <span class="n">commands</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">commands</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>

    <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="n">commands</span> <span class="o">=</span> <span class="p">[</span><span class="n">cmd</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">cmd</span> <span class="ow">in</span> <span class="n">commands</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">commands</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-17'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-17'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">read_inputs</span><span class="p">(</span><span class="n">file_name</span><span class="p">):</span>
    <span class="n">line</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">line</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
    <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="n">inputs</span> <span class="o">=</span> <span class="p">[</span><span class="n">get_raw_val</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)]</span>
    <span class="k">return</span> <span class="n">inputs</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-18'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-18'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">read_init</span><span class="p">(</span><span class="n">file_name</span><span class="p">):</span>
    <span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">memspace</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">constants</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>

    <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="n">memspace</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
    <span class="n">memspace</span> <span class="o">=</span> <span class="n">get_raw_val</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">constants</span> <span class="o">=</span> <span class="p">[</span><span class="n">get_raw_val</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)]</span>
    <span class="k">return</span> <span class="n">memspace</span><span class="p">,</span> <span class="n">constants</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-19'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-19'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">print_log</span><span class="p">(</span><span class="n">line</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="n">line</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-20'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-20'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">print_error</span><span class="p">(</span><span class="n">line</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Error: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">line</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-21'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-21'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">check_file</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
        <span class="n">print_error</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> not found&quot;</span> <span class="o">%</span> <span class="n">filename</span><span class="p">)</span>
        <span class="nb">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">&quot;HRM Instructions Interpreter&quot;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--init&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;file path to init VM data&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;init_vm.txt&quot;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;init_filename&quot;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--cmd&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;file path to commands data&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;commands.txt&quot;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;cmd_filename&quot;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--input&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;file path to input data&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;inputs.txt&quot;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;in_filename&quot;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--verbose&quot;</span><span class="p">,</span> <span class="s2">&quot;-v&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;print log&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;count&quot;</span><span class="p">)</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>
    <span class="n">init_filename</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">init_filename</span>
    <span class="n">check_file</span><span class="p">(</span><span class="n">init_filename</span><span class="p">)</span>
    <span class="n">cmd_filename</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">cmd_filename</span>
    <span class="n">check_file</span><span class="p">(</span><span class="n">cmd_filename</span><span class="p">)</span>
    <span class="n">in_filename</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">in_filename</span>
    <span class="n">check_file</span><span class="p">(</span><span class="n">in_filename</span><span class="p">)</span>
    <span class="n">verbose</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">verbose</span> <span class="k">else</span> <span class="bp">False</span>
    <span class="n">memspace</span><span class="p">,</span> <span class="n">constants</span> <span class="o">=</span> <span class="n">read_init</span><span class="p">(</span><span class="n">init_filename</span><span class="p">)</span>
    <span class="n">mem</span> <span class="o">=</span> <span class="n">init_vm</span><span class="p">(</span><span class="n">memspace</span><span class="p">,</span> <span class="n">constants</span><span class="p">)</span>
    <span class="n">commands</span> <span class="o">=</span> <span class="n">read_commands</span><span class="p">(</span><span class="n">cmd_filename</span><span class="p">)</span>
    <span class="n">inputs</span> <span class="o">=</span> <span class="n">read_inputs</span><span class="p">(</span><span class="n">in_filename</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;inputs: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">inputs</span><span class="p">)</span>
    <span class="n">outputs</span> <span class="o">=</span> <span class="n">run_commands</span><span class="p">(</span><span class="n">mem</span><span class="p">,</span> <span class="n">commands</span><span class="p">,</span> <span class="n">inputs</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;outputs: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">outputs</span><span class="p">)</span>

</pre></div>
    </div>
  </div>
  <div class='clearall'></div>
</div>
</body>
